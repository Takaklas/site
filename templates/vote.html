<!DOCTYPE html>
<html lang="en" >
<html xmlns = "http://www.w3.org/1999/xhtml">
<head>
    <title>AI Melodies Composer</title>
    <meta name="viewport" content="width=1060px, maximum-scale=0.5" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/particles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/toggle.css') }}">
</head>

<body style = "background-color: #1F2439; overflow-y: scroll;" >
    <div id="particles-js"></div>

    <div class="text text-center" style="min-width: 500px; min-height: 300px">
        <div id = "title">
        <h2 style="display: inline">Your help will make our </h2>
        <h1 style="display: inline; color: #5382CA;">AI</h1> <h2 style="display: inline">  even smarter!</h2>
        </div>
        <br>
        <div class = "block text-center" style="min-width: 500px;">
        <h3>Just Listen and answer the questions</h3>
        
        <button type="button" class = 'btn-sm-block' onclick="playbtn()">
            <img id = 'play_btn' src="{{ url_for('static', filename='images/play.png') }}" alt="Play Button"  height="50" width="50">
        </button>
        <br>
        <h4>Who do you think has composed this melodie?</h4>
        <label>
            <input type="radio" name="creator" value="1" onclick="change_creator()">
            <img id = "human" src="{{ url_for('static', filename='images/human.png') }}" weight= "40" height= "40">
        </label>
        <label>
            <input type="radio" name="creator" value="2" onclick="change_creator()">
            <img id = "computer" src="{{ url_for('static', filename='images/computer.png') }}" weight= "40" height= "40">
        </label>
        <br>
        <h4>How much do you like this melodie?</h4>
        <label>
            <input type="radio" name="satisfaction" value="1" onclick="change_satisfaction()">
            <img id = "s1" src="{{ url_for('static', filename='images/1.png') }}" weight= "40" height= "40">
        </label>
        <label>
            <input type="radio" name="satisfaction" value="2" onclick="change_satisfaction()">
            <img id = "s2" src="{{ url_for('static', filename='images/2.png') }}" weight= "40" height= "40">
        </label>
        <label>
            <input type="radio" name="satisfaction" value="3" onclick="change_satisfaction()">
            <img id = "s3" src="{{ url_for('static', filename='images/3.png') }}" weight= "40" height= "40">
        </label>
        <label>
            <input type="radio" name="satisfaction" value="4" onclick="change_satisfaction()">
            <img id = "s4" src="{{ url_for('static', filename='images/4.png') }}" weight= "40" height= "40">
        </label>
        <label>
            <input type="radio" name="satisfaction" value="5" onclick="change_satisfaction()">
            <img id = "s5" src="{{ url_for('static', filename='images/5.png') }}" weight= "40" height= "40">
        </label>
        <br>
        <h4>How interesting do you find that melodie?</h4>
        <label>
            <input type="radio" name="interesting" value="1" onclick="change_interesting()">
            <img id = "i1" src="{{ url_for('static', filename='images/1.png') }}" weight= "40" height= "40">
        </label>
        <label>
            <input type="radio" name="interesting" value="2" onclick="change_interesting()">
            <img id = "i2" src="{{ url_for('static', filename='images/2.png') }}" weight= "40" height= "40">
        </label>
        <label>
            <input type="radio" name="interesting" value="3" onclick="change_interesting()">
            <img id = "i3" src="{{ url_for('static', filename='images/3.png') }}" weight= "40" height= "40">
        </label>
        <label>
            <input type="radio" name="interesting" value="4" onclick="change_interesting()">
            <img id = "i4" src="{{ url_for('static', filename='images/4.png') }}" weight= "40" height= "40">
        </label>
        <label>
            <input type="radio" name="interesting" value="5" onclick="change_interesting()">
            <img id = "i5" src="{{ url_for('static', filename='images/5.png') }}" weight= "40" height= "40">
        </label>
        <br><br>
        <button id= "next" disabled type="button" class ='button btn btn-md' onclick="insert()" style="color: black; background-color: white;" title="Submit and listen the next song">
            Next <span class="glyphicon glyphicon-menu-right"></span>
        </button>
        <br>
    </div>
    
    <div id = "content" style = "line-height: 0.9">
        <br>
        <p>For more details about our work press <a href=''>here</a>!</p>
        <p>See the code on <a href='https://github.com/geofila/Music-Generation'>Github</a>.</p>
        <p>At any time you can play with models! Just press <a href="/">Here!</a></p>
    </div>

    </div>

    <div class="footer">
        <button id = "help" type="button" onclick="help()"><span class="glyphicon glyphicon-info-sign"></span></button>
    </div>

    <!-- The Modal -->
    <div class="modal fade" id="myModal">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <br>
                <!-- Modal Header -->
                <div class="modal-header">
                    <h3 class="modal-title text-center">Help us to make AI even better...</h3>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
        
                <!-- Modal body -->
                <div class="modal-body">
                    <h4>
                        Καλώς όρισες  στην σελίδα αξιολόγησης των μοντέλων τεχνιτής νοημοσύνης, τα όποια έχουν κατασκευαστεί με σκοπό τη  αυτόματη σύνθεση μελωδιών.

                        Στην συνέχεια θα ακούσεις διάφορα κομμάτια όπου το κάθε ένα από αυτά είναι τυχαία επιλεγμένο από διαφορετικό μοντέλο, με διαφορετικούς παραμέτρους, με διαφορετικά σύνολα εκπαίδευσης και διαφορετικές αρχικές ακολουθίες. Παρόλα αυτά ανάμεσα στα κομμάτια που θα ακούσεις υπάρχουν και πραγματικές μελωδίες και κάθε φορά η μελωδία που παίζεται μπορεί να είναι είτε πραγματική είτε κατασκευασμένη από υπολογιστή.
                        Αξίζει να σημειωθεί οτι η αρχική μελωδία είναι κοινή για κάθε μοντέλο και το μόνο που αλλάζει είναι το πως κάθε ένα από αυτά συνεχίζει την συνθεσή της. Συνεπώς μπορεί ορισμένα κομμάτια στην αρχή να ξεκινούν με τον ίδιο τρόπο αλλα η συνεχεία τους θα είναι σίγουρα διαφορετική.
                        <br><br>
                    </h4>

                    <div style="text-align: center;">
                        <button type="button" class="btn btn-default" onclick = "start()">Επόμενο
                            <span class="glyphicon glyphicon-menu-right"></span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- The Modal2 -->
    <div class="modal fade" id="myModal2" style="overflow-y: auto;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <br>
                <!-- Modal Header -->
                <div class="modal-header">
                    <h3 class="modal-title text-center">Help us to make AI even better...</h3>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
            
                <!-- Modal body -->
                <div class="modal-body">
                    <h4>
                        Κάθε ένα από τα μοντέλα αυτά συνθέτουν την μελωδία σαν μια ακολουθία νοτών (midi format) και δεν παράγουν απευθείας audio αρχεία. Αυτό σημαίνει ότι για την αναπαραγωγή των κομματιών εμπλέκονται και ορισμένοι εξωγενείς παράγοντες όπως το ποιο πρόγραμμα θα αναλάβει την αναπαραγωγή της μελωδίας, από ποιο ακριβώς όργανο έχει καταγράψει την κάθε νότα κ.α. Αυτό σημαίνει ότι το ίδιο μουσικό κομμάτι μπορεί να ακούγεται διαφορετικά από εδώ και διαφορετικά αν παίζεται από ένα άλλο πρόγραμμά αναπαραγωγής (π.χ. Windows Player)
                        Επίσης κατά την αποκωδικοποίηση των πραγματικών μελωδιών ορισμένη πληροφορία θυσιαστικέ με σκοπό το σύστημα μας κάθε φορά να επικεντρώνεται στα σημαντικά κομμάτια της μουσικής πληροφορίας.
                        <br><br>Για παράδειγμα έτσι ακούγεται μια πραγματική μελωδία όπως την βλέπει το σύστημα μας.

                    </h4>

                    <button type="button" class = 'center-block' onclick = 'play_helper1()'>
                        <img id = 'play_btn_real' src="{{ url_for('static', filename='images/playb.png') }}" alt="Play Button"  height="30" width="30">
                    </button>
                    <h4>Έτσι ακούγεται μια μελωδία η οποιά έχει συντεθεί από ένα από τα μοντέλα μας.</h4>
                    <button type="button" class = 'center-block' onclick = 'play_helper2()'>
                        <img id = 'play_btn_fake' src="{{ url_for('static', filename='images/playb.png') }}" alt="Play Button"  height="30" width="30">
                    </button>
                    <br>
                     <h4><center> Πιστευείς οτι μπορείς να καταλάβεις την διαφορα?</center></h4>
                    <div style="text-align: center;">
                        <button type="button" class="btn btn-default" onclick = "next1()">Επόμενο
                             <span class="glyphicon glyphicon-menu-right"></span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- The Modal -->
    <div class="modal fade" id="myModal3" style="overflow-y: auto;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <br>
                <!-- Modal Header -->
                <div class="modal-header">
                    <h3 class="modal-title text-center">Help us to make AI even better...</h3>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
        
                <!-- Modal body -->
                <div class="modal-body">
                    <h4>Αυτό που πρέπει να κάνεις σε αυτό το σημείο είναι απλά να ακούσεις τα διάφορα κομμάτια (πατώντας το play button) και αφού ακούσεις για το κάθε ένα να απαντήσεις στο αν πιστεύεις ότι η μελωδία αυτή είναι πραγματική, πόσο αυτή σου αρέσει αυτή και κατά πόσο την βρήκες ενδιαφέρουσα. 
                    <br><br>Τελός κάθε στιγμή μπορείς να σταματήσεις την διαδικασία αξιολόγησης απλά πηγαίνοντας στην προηγούμνη σελίδα 
                    και να πειραματιστείς με τα αποτελέσματα των μοντέλων. Έστω και μια αξιολόγηση είναι σημαντική!</h4>
                    <br>
                    <div style="text-align: center;">
                        <h4 id = "red"> </h4>
                        <h4 id = "red2"> Ποσο καλά γνωρίζεις μουσική;</h4>
                        <label>
                            <input type="radio" name="musician" value="user" onclick="change_musician()">
                            <img id = "m1" src="{{ url_for('static', filename='images/1.png') }}" weight= "60" height= "60">
                        </label>

                        <label>
                            <input type="radio" name="musician" value="mucisian" onclick="change_musician()">
                            <img id = "m5" src="{{ url_for('static', filename='images/5.png') }}" weight= "60" height= "60">
                        </label>
                        <br><br>
                        <button type="button" class="btn btn-default" onclick = "last()">Ας Ξεκινήσoυμε
                            <span class="glyphicon glyphicon-menu-right"></span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <audio id = "melodies" controls loop style="display: none;">
        <source src="{{ url_for('static', filename='AGIG512_1261287_1.3616.mp3')}}" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio> 
    <audio id = "real_melodie" controls loop style="display: none;">
        <source src="{{ url_for('static', filename='samples/RG_714710.mp3')}}" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio> 
    <audio id = "fake_melodie" controls loop style="display: none;">
        <source src="{{ url_for('static', filename='samples/APIP512_304496.mp3')}}" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio> 

    <script src='https://cldup.com/S6Ptkwu_qA.js'></script>
    <script src="{{ url_for('static', filename='js/particles.js') }}"></script>
    <script src="{{ url_for('static', filename='js/vote.js') }}"></script>

<script>
    var creator = 0;
    var satisfaction = 0;
    var interesting = 0;
    var files;
    var audio = document.getElementById('melodies');
    var img = document.getElementById('play_btn');
    var songs;

    var musician = 0;


    window.onload = function () {
        if (screen.width < 800) {
            document.getElementById("title").style.paddingLeft = "85px";
            document.getElementById("content").style.paddingLeft = "85px";
            document.getElementByClassName("block").style.borderRadius = "0px";
        }
        $('#myModal').modal('show'); 
        $("#next").prop('disabled', true); 
        $.ajax({
            data : {
                // network : $("input[name='model']:checked").val(),
            },
            url: "/get_melodies",
            type: "POST",
            success: function(resp){
                files = resp.files;
                songs = shuffle(files);
                audio.src = "static/samples/" + songs[0];
                songs.shift();
            }
        });
    };

    $('#myModal3').on('hidden.bs.modal', function () {
        if (musician == 0) {
            $("#red").css("color","#8d0c0c");
            $('#red').text("Τελευταίο βήμα και φυγάμε!")
            $('#myModal3').modal('show'); 
        }
    })
    $('#myModal').on('hidden.bs.modal', function () {
        $('#myModal2').modal('show'); 
    })

    $('#myModal2').on('hidden.bs.modal', function () {
        $('#myModal3').modal('show');
        var audio = document.getElementById('real_melodie');
        var audio2 = document.getElementById('fake_melodie');
        audio2.pause();
        audio.pause()

    })

    function start(){        
        $('#myModal').modal('hide');
        $('#myModal2').modal('show');
    }
    function next1(){
        $('#myModal2').modal('hide');
        $('#myModal3').modal('show');
    }
    function last(){
        $('#myModal3').modal('hide');
    }

    function help(){
        $('#myModal').modal('show'); 
        if (musician == "user"){
            document.getElementById('m1').src = 'static/images/1b.png';
            document.getElementById('m5').src = 'static/images/5.png';
        }
        else {
            document.getElementById('m1').src = 'static/images/1.png';
            document.getElementById('m5').src = 'static/images/5b.png';
        }
    }
        
    function play_helper1(){
        var img = document.getElementById('play_btn_real');
        var img2 = document.getElementById('play_btn_fake');
        img2.src = "static/images/playb.png";

        var audio = document.getElementById('real_melodie');
        var audio2 = document.getElementById('fake_melodie');
        audio2.pause();

        if (audio.duration > 0 && !audio.paused){
            img.src = "static/images/playb.png";
            audio.pause();
        }else{
            img.src = "static/images/pauseb.png";
            audio.play();
        }
    }

    function play_helper2(){
        var img = document.getElementById('play_btn_fake');
        var img2 = document.getElementById('play_btn_real');
        img2.src = "static/images/playb.png";

        var audio = document.getElementById('fake_melodie');
        var audio2 = document.getElementById('real_melodie');
        audio2.pause();

        if (audio.duration > 0 && !audio.paused){
            img.src = "static/images/playb.png";
            audio.pause();
        }else{
            img.src = "static/images/pauseb.png";
            audio.play();
        }
    }
</script>
</body>
</html>
